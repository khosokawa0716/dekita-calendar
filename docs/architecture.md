# ã‚¢ãƒ¼ã‚­ãƒ†ã‚¯ãƒãƒ£è¨­è¨ˆ

## ğŸ—ï¸ ã‚·ã‚¹ãƒ†ãƒ æ¦‚è¦

ã§ããŸã‚ˆã‚«ãƒ¬ãƒ³ãƒ€ãƒ¼ã¯ã€å®¶æ—å‘ã‘ã‚¿ã‚¹ã‚¯ç®¡ç†ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ã§ã™ã€‚è¦ªãŒå­ã©ã‚‚ã«ã‚¿ã‚¹ã‚¯ã‚’å‰²ã‚Šå½“ã¦ã€å­ã©ã‚‚ãŒã‚¿ã‚¹ã‚¯ã‚’å®Œäº†ã—ã¦ã„ãä»•çµ„ã¿ã‚’æä¾›ã—ã¦ã„ã¾ã™ã€‚

## ğŸ“‹ æŠ€è¡“ã‚¹ã‚¿ãƒƒã‚¯

### ãƒ•ãƒ­ãƒ³ãƒˆã‚¨ãƒ³ãƒ‰

- **Framework**: Next.js 14 (App Router)
- **Language**: TypeScript
- **Styling**: Tailwind CSS
- **State Management**: React Hooks (useState, useEffect)

### ãƒãƒƒã‚¯ã‚¨ãƒ³ãƒ‰ãƒ»ã‚¤ãƒ³ãƒ•ãƒ©

- **Database**: Firebase Firestore
- **Authentication**: Firebase Auth
- **Hosting**: Vercel (æ¨å¥¨)

### é–‹ç™ºãƒ„ãƒ¼ãƒ«

- **Linting**: ESLint
- **Formatting**: Prettier
- **Version Control**: Git

## ğŸ¯ è¨­è¨ˆæ€æƒ³

### 1. APIå±¤ã«ã‚ˆã‚‹æŠ½è±¡åŒ–

Firebaseæ“ä½œã‚’ç›´æ¥è¡Œã‚ãšã€APIå±¤ã‚’çµŒç”±ã™ã‚‹ã“ã¨ã§ä»¥ä¸‹ã‚’å®Ÿç¾ï¼š

- **ä¿å®ˆæ€§**: ãƒ‡ãƒ¼ã‚¿ã‚¢ã‚¯ã‚»ã‚¹ãƒ­ã‚¸ãƒƒã‚¯ã®é›†ç´„
- **ãƒ†ã‚¹ã‚¿ãƒ“ãƒªãƒ†ã‚£**: APIå±¤ã®ãƒ¢ãƒƒã‚¯åŒ–ãŒå®¹æ˜“
- **å‹å®‰å…¨æ€§**: TypeScriptå‹å®šç¾©ã®æ´»ç”¨
- **ã‚¨ãƒ©ãƒ¼ãƒãƒ³ãƒ‰ãƒªãƒ³ã‚°**: çµ±ä¸€ã•ã‚ŒãŸã‚¨ãƒ©ãƒ¼å‡¦ç†

```typescript
// âŒ ç›´æ¥Firebaseæ“ä½œï¼ˆå¾“æ¥ï¼‰
const q = query(collection(db, 'tasks'), where('familyId', '==', familyId))
const snapshot = await getDocs(q)

// âœ… APIå±¤çµŒç”±ï¼ˆç¾åœ¨ï¼‰
const tasks = await taskAPI.getByFamilyId(familyId)
```

### 2. ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆåˆ†é›¢

- **Page Components**: ãƒšãƒ¼ã‚¸å˜ä½ã®ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆ
- **Shared Components**: å†åˆ©ç”¨å¯èƒ½ãªUIã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆ
- **Custom Hooks**: ãƒ“ã‚¸ãƒã‚¹ãƒ­ã‚¸ãƒƒã‚¯ã®æŠ½è±¡åŒ–

### 3. å‹å®‰å…¨æ€§ã®é‡è¦–

- å…¨ã¦ã®ãƒ‡ãƒ¼ã‚¿æ§‹é€ ã‚’TypeScriptã§å®šç¾©
- APIå±¤ã§ã®å‹ãƒã‚§ãƒƒã‚¯
- ã‚³ãƒ³ãƒ‘ã‚¤ãƒ«æ™‚ã‚¨ãƒ©ãƒ¼ã®æœ€å¤§åŒ–

## ğŸ“‚ ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªæ§‹æˆ

```
src/
â”œâ”€â”€ app/                     # Next.js App Router
â”‚   â”œâ”€â”€ globals.css         # ã‚°ãƒ­ãƒ¼ãƒãƒ«ã‚¹ã‚¿ã‚¤ãƒ«
â”‚   â”œâ”€â”€ layout.tsx          # ãƒ«ãƒ¼ãƒˆãƒ¬ã‚¤ã‚¢ã‚¦ãƒˆ
â”‚   â”œâ”€â”€ page.tsx           # ãƒˆãƒƒãƒ—ãƒšãƒ¼ã‚¸
â”‚   â”œâ”€â”€ login/             # ãƒ­ã‚°ã‚¤ãƒ³ãƒšãƒ¼ã‚¸
â”‚   â”œâ”€â”€ signup/            # ã‚µã‚¤ãƒ³ã‚¢ãƒƒãƒ—ãƒšãƒ¼ã‚¸
â”‚   â”œâ”€â”€ setting/           # è¨­å®šãƒšãƒ¼ã‚¸
â”‚   â”œâ”€â”€ tasks/             # ã‚¿ã‚¹ã‚¯é–¢é€£ãƒšãƒ¼ã‚¸
â”‚   â”‚   â”œâ”€â”€ page.tsx       # ã‚¿ã‚¹ã‚¯ä¸€è¦§
â”‚   â”‚   â”œâ”€â”€ add/           # ã‚¿ã‚¹ã‚¯è¿½åŠ 
â”‚   â”‚   â”œâ”€â”€ edit/[id]/     # ã‚¿ã‚¹ã‚¯ç·¨é›†
â”‚   â”‚   â””â”€â”€ calendar/      # ã‚«ãƒ¬ãƒ³ãƒ€ãƒ¼è¡¨ç¤º
â”‚   â””â”€â”€ task-templates/    # ãƒ†ãƒ³ãƒ—ãƒ¬ãƒ¼ãƒˆé–¢é€£ãƒšãƒ¼ã‚¸
â”‚       â”œâ”€â”€ page.tsx       # ãƒ†ãƒ³ãƒ—ãƒ¬ãƒ¼ãƒˆä¸€è¦§
â”‚       â”œâ”€â”€ create/        # ãƒ†ãƒ³ãƒ—ãƒ¬ãƒ¼ãƒˆä½œæˆ
â”‚       â””â”€â”€ edit/[id]/     # ãƒ†ãƒ³ãƒ—ãƒ¬ãƒ¼ãƒˆç·¨é›†
â”œâ”€â”€ components/            # å…±æœ‰ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆ
â”‚   â”œâ”€â”€ AuthGuard.tsx     # èªè¨¼ã‚¬ãƒ¼ãƒ‰
â”‚   â”œâ”€â”€ RoleGuard.tsx     # ãƒ­ãƒ¼ãƒ«ãƒ™ãƒ¼ã‚¹ã‚¢ã‚¯ã‚»ã‚¹åˆ¶å¾¡
â”‚   â”œâ”€â”€ Calendar.tsx      # ã‚«ãƒ¬ãƒ³ãƒ€ãƒ¼ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆ
â”‚   â”œâ”€â”€ Navigation.tsx    # ãƒŠãƒ“ã‚²ãƒ¼ã‚·ãƒ§ãƒ³
â”‚   â””â”€â”€ Toast.tsx         # é€šçŸ¥ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆ
â”œâ”€â”€ hooks/                # ã‚«ã‚¹ã‚¿ãƒ ãƒ•ãƒƒã‚¯
â”‚   â”œâ”€â”€ useAuthRedirect.ts
â”‚   â”œâ”€â”€ useUserInfo.ts
â”‚   â””â”€â”€ useFamilyChildren.ts
â”œâ”€â”€ lib/                  # ãƒ¦ãƒ¼ãƒ†ã‚£ãƒªãƒ†ã‚£ãƒ»è¨­å®š
â”‚   â”œâ”€â”€ api/             # APIå±¤
â”‚   â”‚   â”œâ”€â”€ index.ts     # çµ±åˆã‚¨ã‚¯ã‚¹ãƒãƒ¼ãƒˆ
â”‚   â”‚   â”œâ”€â”€ tasks.ts     # ã‚¿ã‚¹ã‚¯API
â”‚   â”‚   â”œâ”€â”€ taskTemplates.ts # ãƒ†ãƒ³ãƒ—ãƒ¬ãƒ¼ãƒˆAPI
â”‚   â”‚   â”œâ”€â”€ users.ts     # ãƒ¦ãƒ¼ã‚¶ãƒ¼API
â”‚   â”‚   â””â”€â”€ achievements.ts # é”æˆè¨˜éŒ²API
â”‚   â”œâ”€â”€ firebase.ts      # Firebaseè¨­å®š
â”‚   â””â”€â”€ dateUtils.ts     # æ—¥ä»˜ãƒ¦ãƒ¼ãƒ†ã‚£ãƒªãƒ†ã‚£
â””â”€â”€ types/               # TypeScriptå‹å®šç¾©
    â””â”€â”€ task.ts          # ã‚¿ã‚¹ã‚¯é–¢é€£ã®å‹
```

## ğŸ”„ ãƒ‡ãƒ¼ã‚¿ãƒ•ãƒ­ãƒ¼

### 1. èªè¨¼ãƒ•ãƒ­ãƒ¼

```
User Login â†’ Firebase Auth â†’ useUserInfo Hook â†’ User State
```

### 2. ãƒ‡ãƒ¼ã‚¿å–å¾—ãƒ•ãƒ­ãƒ¼

```
Component â†’ API Layer â†’ Firebase Firestore â†’ Data Transform â†’ Component State
```

### 3. ãƒ‡ãƒ¼ã‚¿æ›´æ–°ãƒ•ãƒ­ãƒ¼

```
User Action â†’ API Layer â†’ Firebase Firestore â†’ Local State Update â†’ UI Re-render
```

## ğŸ›¡ï¸ ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£è¨­è¨ˆ

### 1. èªè¨¼ãƒ»èªå¯

- **Firebase Auth**: ãƒ¡ãƒ¼ãƒ«ãƒ»ãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰èªè¨¼
- **Role-based Access Control**: è¦ªãƒ»å­ã®æ¨©é™ç®¡ç†
- **Route Protection**: èªè¨¼ãŒå¿…è¦ãªãƒšãƒ¼ã‚¸ã®ä¿è­·

### 2. ãƒ‡ãƒ¼ã‚¿ã‚¢ã‚¯ã‚»ã‚¹åˆ¶å¾¡

- **Family-based Isolation**: å®¶æ—å˜ä½ã§ã®ãƒ‡ãƒ¼ã‚¿åˆ†é›¢
- **Role-based Operations**: æ“ä½œæ¨©é™ã®åˆ¶é™
- **Input Validation**: APIå±¤ã§ã®ãƒ‡ãƒ¼ã‚¿æ¤œè¨¼

### 3. Firestore Security Rules

```javascript
// å®¶æ—ãƒ‡ãƒ¼ã‚¿ã®åˆ†é›¢
allow read, write: if request.auth != null
  && resource.data.familyId == getUserFamilyId(request.auth.uid);
```

## ğŸ“Š ãƒ‡ãƒ¼ã‚¿ãƒ¢ãƒ‡ãƒ«è¨­è¨ˆ

### ã‚³ãƒ¬ã‚¯ã‚·ãƒ§ãƒ³æ§‹æˆ

```
firestore/
â”œâ”€â”€ users/           # ãƒ¦ãƒ¼ã‚¶ãƒ¼æƒ…å ±
â”œâ”€â”€ tasks/           # ã‚¿ã‚¹ã‚¯ãƒ‡ãƒ¼ã‚¿
â”œâ”€â”€ taskTemplates/   # ã‚¿ã‚¹ã‚¯ãƒ†ãƒ³ãƒ—ãƒ¬ãƒ¼ãƒˆ
â””â”€â”€ achievements/    # é”æˆè¨˜éŒ²
```

### ãƒªãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³è¨­è¨ˆ

- **Users â† FamilyId â†’ Tasks**: å®¶æ—ã«ã‚ˆã‚‹ãƒ‡ãƒ¼ã‚¿åˆ†é›¢
- **Users â† CreatedBy â†’ TaskTemplates**: ä½œæˆè€…ã«ã‚ˆã‚‹ç®¡ç†
- **Tasks â†’ ChildrenStatus**: è¤‡æ•°å­ã©ã‚‚ã®çŠ¶æ…‹ç®¡ç†

ğŸ“‹ **è©³ç´°ãªã‚³ãƒ¬ã‚¯ã‚·ãƒ§ãƒ³æ§‹é€ ã«ã¤ã„ã¦ã¯ [ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹è¨­è¨ˆæ›¸](database-schema.md) ã‚’å‚ç…§ã—ã¦ãã ã•ã„ã€‚**

## ğŸš€ ãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹è€ƒæ…®äº‹é …

### 1. ã‚¯ã‚¨ãƒªæœ€é©åŒ–

- **ã‚¤ãƒ³ãƒ‡ãƒƒã‚¯ã‚¹**: è¤‡åˆã‚¯ã‚¨ãƒªã«å¯¾ã™ã‚‹ã‚¤ãƒ³ãƒ‡ãƒƒã‚¯ã‚¹è¨­å®š
- **Pagination**: å¤§é‡ãƒ‡ãƒ¼ã‚¿ã®åˆ†å‰²å–å¾—
- **Caching**: é©åˆ‡ãªãƒ‡ãƒ¼ã‚¿ã‚­ãƒ£ãƒƒã‚·ãƒ¥

### 2. ãƒªã‚¢ãƒ«ã‚¿ã‚¤ãƒ æ›´æ–°

- **Firestore Realtime Listeners**: å¿…è¦æœ€å°é™ã®ä½¿ç”¨
- **Local State Management**: ã‚¯ãƒ©ã‚¤ã‚¢ãƒ³ãƒˆå´ã‚­ãƒ£ãƒƒã‚·ãƒ¥

### 3. ãƒãƒ³ãƒ‰ãƒ«ã‚µã‚¤ã‚ºæœ€é©åŒ–

- **Tree Shaking**: æœªä½¿ç”¨ã‚³ãƒ¼ãƒ‰ã®é™¤å»
- **Dynamic Imports**: å¿…è¦æ™‚ã®ã¿ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆèª­ã¿è¾¼ã¿

## ğŸ”§ é–‹ç™ºãƒ»é‹ç”¨è€ƒæ…®äº‹é …

### 1. ç’°å¢ƒåˆ†é›¢

```
Development â†’ Firebase Project (dev)
Production  â†’ Firebase Project (prod)
```

### 2. ãƒ­ã‚°ãƒ»ç›£è¦–

- **Console Logging**: é–‹ç™ºæ™‚ã®ãƒ‡ãƒãƒƒã‚°æƒ…å ±
- **Error Tracking**: æœ¬ç•ªç’°å¢ƒã§ã®ã‚¨ãƒ©ãƒ¼ç›£è¦–
- **Performance Monitoring**: ãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹è¨ˆæ¸¬

### 3. CI/CD

```
Git Push â†’ GitHub Actions â†’ Build & Test â†’ Deploy to Vercel
```

## ğŸ”„ ä»Šå¾Œã®æ‹¡å¼µæ€§

### 1. æ©Ÿèƒ½æ‹¡å¼µ

- **é€šçŸ¥æ©Ÿèƒ½**: ãƒ—ãƒƒã‚·ãƒ¥é€šçŸ¥ãƒ»ãƒ¡ãƒ¼ãƒ«é€šçŸ¥
- **ãƒ¬ãƒãƒ¼ãƒˆæ©Ÿèƒ½**: é”æˆç‡ãƒ¬ãƒãƒ¼ãƒˆ
- **ã‚²ãƒ¼ãƒŸãƒ•ã‚£ã‚±ãƒ¼ã‚·ãƒ§ãƒ³**: ãƒã‚¤ãƒ³ãƒˆãƒ»ãƒãƒƒã‚¸ã‚·ã‚¹ãƒ†ãƒ 

### 2. æŠ€è¡“çš„æ‹¡å¼µ

- **PWAåŒ–**: ã‚ªãƒ•ãƒ©ã‚¤ãƒ³å¯¾å¿œ
- **ãƒãƒ«ãƒãƒ†ãƒŠãƒ³ãƒˆ**: çµ„ç¹”å˜ä½ã®ç®¡ç†
- **APIå¤–éƒ¨å…¬é–‹**: REST API/GraphQL

### 3. é‹ç”¨é¢æ‹¡å¼µ

- **å¤šè¨€èªå¯¾å¿œ**: i18nå°å…¥
- **ã‚¢ã‚¯ã‚»ã‚·ãƒ“ãƒªãƒ†ã‚£**: WCAGæº–æ‹ 
- **ãƒ¢ãƒã‚¤ãƒ«ã‚¢ãƒ—ãƒª**: React Nativeå±•é–‹
